# Architecture Decisions

이 문서는 **One-Core Architecture**를 설계하면서 내린 주요 기술적 의사결정과 그 배경을 기록합니다.
"왜 이 선택을 했는가"를 명확히 설명하는 것을 목표로 합니다.

---

## 1. 왜 단일 도메인 코어(One Core) 아키텍처인가?

### 배경 (Problem)

* 현업 환경에서는 기존 레거시 시스템과 조직 구조로 인해

  * 모든 시스템을 전면 재설계하거나
  * 인프라/아키텍처를 급진적으로 변경하는 것이 현실적으로 불가능
* 그 결과, 부분적인 개선만 반복되며 구조적 병목은 계속 누적됨

### 개인적 제약과 접근 방식

* 현업 제약 속에서 **"지금 당장 적용 가능한 최선의 구조"**를 고민
* 이상적인 MSA가 아닌, 점진적으로 적용 가능한 아키텍처를 목표로 설정
* 실제 적용 가능성을 기준으로 아키텍처를 학습·비교·검증

### 고려한 대안

* 시스템별 독립 유지 (현상 유지)
* MSA 기반 완전 분리 (이상적이지만 현실적 제약 큼)

### 선택 이유 (Decision)

* 핵심 비즈니스 규칙만이라도 단일 도메인 코어로 통합하여

  * 구조적 병목을 최소 단위에서부터 해소
  * 기존 시스템은 어댑터 형태로 점진적 전환 가능
* 현업 제약 하에서도 적용 가능한 현실적인 대안이라고 판단

### 결과 (Consequence)

* 전면 재구축 없이도 도메인 일관성 확보
* 점진적 개선이 가능한 구조적 기반 마련
* 향후 조직·시스템 성숙도에 따라 MSA로 확장 가능

---

## 2. 왜 Domain-Driven Design(DDD)를 도입했는가?

### 배경 (Problem)

* 기존 구조는 CRUD 중심으로 구성되어

  * 비즈니스 규칙이 서비스/컨트롤러에 분산
  * 도메인 로직의 책임이 불분명

### 고려한 대안

* 전통적인 Layered Architecture
* Transaction Script 패턴

### 선택 이유 (Decision)

* 비즈니스 규칙을 코드 구조로 명확히 표현하기 위함
* 도메인을 중심으로 한 설계로 유지보수성 확보
* 기술보다 도메인 언어(Ubiquitous Language)를 우선

### 결과 (Consequence)

* 도메인 로직의 응집도 향상
* 신규 요구사항 반영 시 영향 범위 예측 가능

---

## 3. 왜 Event-Driven 아키텍처를 선택했는가?

### 배경 (Problem)

* 동기 연동 방식으로 인해

  * 외부 시스템 장애가 내부 장애로 전파
  * 트래픽 스파이크 시 스레드 고갈 발생

### 고려한 대안

* 동기 REST 연동 유지
* 메시지 큐 기반 비동기 처리

### 선택 이유 (Decision)

* Core 도메인의 안정성을 최우선으로 보호
* 상태 변경을 이벤트로 표현하여 느슨한 결합 유지
* 장애 격리 및 비동기 확장성 확보

### 결과 (Consequence)

* 외부 시스템 장애가 Core에 영향을 주지 않음
* 트래픽 증가 시에도 안정적인 처리 가능

---

## 4. 왜 Redis Pub/Sub을 메시지 브로커로 선택했는가?

### 배경 (Problem)

* 이벤트 발행이 필요하지만

  * 메시지 순서 보장 불필요
  * At-Least-Once / Exactly-Once 요구사항 없음

### 고려한 대안

* Kafka
* RabbitMQ

### 선택 이유 (Decision)

* 운영 복잡도와 비용을 최소화하기 위함
* 이미 Redis를 캐시 용도로 사용 중
* 단순 이벤트 전달 목적에 충분한 성능 제공

### 적용 범위

* 메시지 순서 보장이 필요 없는 도메인 이벤트
* 재처리가 필요 없는 비핵심 이벤트

### 결과 (Consequence)

* 빠른 도입과 단순한 운영 구조
* 메시징 인프라 관리 부담 감소

---

## 5. 왜 Hexagonal Architecture (Ports & Adapters)를 적용했는가?

### 배경 (Problem)

* 프레임워크 및 외부 시스템 의존성이 도메인에 침투
* 테스트 어려움 및 교체 비용 증가

### 선택 이유 (Decision)

* 도메인을 외부 환경으로부터 격리
* DB, 메시지 브로커, 외부 연동을 어댑터로 분리

### 결과 (Consequence)

* 도메인 단위 테스트 용이
* 인프라 교체 시 영향 최소화

---

## 6. 이 아키텍처의 한계와 트레이드오프

* 단일 코어는 초기에는 병목 지점이 될 수 있음
* 모든 도메인이 이벤트로만 해결되지는 않음
* 복잡한 분산 트랜잭션은 다루지 않음

➡️ 본 구조는 **현실적인 레거시 개선과 운영 안정성**을 우선한 선택임

---

## 정리

이 문서의 목적은 "정답"을 제시하는 것이 아니라,
**상황에 맞는 합리적인 선택과 그 근거를 설명하는 것**입니다.
